@model TestFlight.Models.IndexConteiner
@{
    ViewBag.Title = "Главная";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- Слайдер -->

<section class="cz-carousel mb-4 mb-sm-5">
    <div class="cz-carousel-inner" data-carousel-options="{&quot;items&quot;: 1, &quot;mode&quot;: &quot;gallery&quot;, &quot;nav&quot;: false, &quot;responsive&quot;: {&quot;0&quot;: {&quot;nav&quot;: true, &quot;controls&quot;: false}, &quot;576&quot;: {&quot;nav&quot;: false, &quot;controls&quot;: true}}}">

        <!-- Слайд 1-->

        <div>
            <div class="rounded-lg px-md-5 text-center text-xl-left" style="background-color: #c3c3c3;">
                <div class="d-xl-flex justify-content-between align-items-center px-4 px-sm-5 mx-auto" style="max-width: 1226px;">
                    <div class="py-5 mr-xl-4 mx-auto mx-xl-0" style="max-width: 490px;">
                        <h2 class="h1 text-light">Свежие продукты в одном клике от Вас</h2>
                        <p class="text-light pb-4">Заказываете продукты онлайн и мы доставляем их в удобное для Вас время</p>
                        <h5 class="text-light pb-3">В дороге? Попробуйте мобильное приложение</h5>
                        <div class="d-flex flex-wrap justify-content-center justify-content-xl-start"><p class="btn-market btn-apple mr-2 mb-2" role="button"><span class="btn-market-subtitle">In process for</span><span class="btn-market-title">App Store</span></p><p class="btn-market btn-google mb-2" role="button"><span class="btn-market-subtitle">In process for</span><span class="btn-market-title">Google Play</span></p></div>
                    </div>
                    <div><img src="~/Images/Slider/slide01.jpg" alt="Image"></div>
                </div>
            </div>
        </div>

        <!-- Слайд 2-->

        <div>
            <div class="rounded-lg px-md-5 text-center text-xl-left" style="background-color: #1a6fb0;">
                <div class="d-xl-flex justify-content-between align-items-center px-4 px-sm-5 mx-auto" style="max-width: 1226px;">
                    <div class="py-5 mr-xl-4 mx-auto mx-xl-0" style="max-width: 490px;">
                        <h2 class="h1 text-light">Сервис доставки 24/7</h2>
                        <p class="text-light pb-4">Заказываете продукты онлайн и мы доставляем их в удобное для Вас время</p>
                        <h5 class="text-light pb-3">В дороге? Попробуйте мобильное приложение</h5>
                        <div class="d-flex flex-wrap justify-content-center justify-content-xl-start"><p class="btn-market btn-apple mr-2 mb-2" role="button"><span class="btn-market-subtitle">In process for</span><span class="btn-market-title">App Store</span></p><p class="btn-market btn-google mb-2" role="button"><span class="btn-market-subtitle">In process for</span><span class="btn-market-title">Google Play</span></p></div>
                    </div>
                    <div><img src="~/Images/Slider/slide02.jpg" alt="Image"></div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Как это работает -->

<section class="pt-4 mb-5">
    <h2 class="h3 text-center mb-grid-gutter pt-2">Как это работает?</h2>
    <div class="row no-gutters bg-light rounded-lg">
        <div class="col-xl-4 col-lg-12 col-md-4 border-right">
            <div class="py-3">
                <div class="d-flex align-items-center mx-auto py-3 px-3" style="max-width: 362px;">
                    <div class="display-2 font-weight-normal border-color mr-4">01</div>
                    <div class="pl-2">
                        <img class="d-block my-2" src="~/Images/Steps/01.png" width="72" alt="Order online">
                        <p class="mb-3 pt-1">Вы заказываете любимые продукты онлайн.</p>
                    </div>
                </div>
                <hr class="d-md-none d-lg-block d-xl-none">
            </div>
        </div>
        <div class="col-xl-4 col-lg-12 col-md-4 border-right">
            <div class="py-3">
                <div class="d-flex align-items-center mx-auto py-3 px-3" style="max-width: 362px;">
                    <div class="display-2 font-weight-normal border-color mr-4">02</div>
                    <div class="pl-2">
                        <img class="d-block my-2" src="~/Images/Steps/02.png" width="72" alt="Grocery collected">
                        <p class="mb-3 pt-1">Мы бережно собираем Ваш заказ.</p>
                    </div>
                </div>
                <hr class="d-md-none d-lg-block d-xl-none">
            </div>
        </div>
        <div class="col-xl-4 col-lg-12 col-md-4">
            <div class="py-3">
                <div class="d-flex align-items-center mx-auto py-3 px-3" style="max-width: 362px;">
                    <div class="display-2 font-weight-normal border-color mr-4">03</div>
                    <div class="pl-2">
                        <img class="d-block my-2" src="~/Images/Steps/03.png" width="72" alt="Delivery">
                        <p class="mb-3 pt-1">И доставляем в удобное для Вас время.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Продукты со скидкой -->

<section class="pt-4">
    <!-- Заголовок-->
    <div class="d-flex flex-wrap justify-content-between align-items-center pt-1 border-bottom pb-4 mb-4">
        <h2 class="h3 mb-0 pt-3 mr-3">Продукты со скидкой</h2>
        <div class="pt-3"><a class="btn btn-outline-accent btn-sm" href="/Home/Catalog?Filter=Discounts">Больше вариантов<i class="czi-arrow-right ml-1 mr-n1"></i></a></div>
    </div>
    <div class="cz-carousel cz-controls-static cz-controls-outside cz-dots-enabled pt-2">
        <div class="cz-carousel-inner" data-carousel-options="{&quot;items&quot;: 2, &quot;gutter&quot;: 16, &quot;controls&quot;: true, &quot;autoHeight&quot;: true, &quot;responsive&quot;: {&quot;0&quot;:{&quot;items&quot;:1}, &quot;480&quot;:{&quot;items&quot;:2}, &quot;720&quot;:{&quot;items&quot;:3}, &quot;991&quot;:{&quot;items&quot;:2}, &quot;1140&quot;:{&quot;items&quot;:3}, &quot;1300&quot;:{&quot;items&quot;:4}, &quot;1500&quot;:{&quot;items&quot;:5}}}">

            @foreach (var discount in Model.DiscountList.ToList())
            {
                <div>
                    <div class="card product-card card-static pb-3">
                        <span class="badge badge-danger badge-shadow">Sale</span>
                        <button class="btn-wishlist btn-sm" id="@discount.Id" type="button" data-toggle="tooltip" data-placement="left" title="В избранное"><i class="czi-heart"></i></button>
                        <a class="card-img-top d-block overflow-hidden" href="/Home/Product/@discount.Id">
                            <img src="~/Images/Products/@discount.Photo.Split('#')[0]" alt="Product">
                        </a>
                        <div class="card-body py-2">
                            <a class="product-meta d-block font-size-xs" href="/Home/Catalog?Filter=Type&id=@discount.ProdTypeId.ToString()&sid=all&tid=all">@discount.ProdTypeName</a>
                            <h3 class="product-title font-size-base" style="margin-bottom:0.3rem"><a href="/Home/Product/@discount.Id">@discount.Name</a></h3>
                            <div class="product-price">
                                <span class="text-accent">₽ @discount.Price.ToString()<small>.00</small></span>
                                <del class="font-size-sm text-muted">
                                    @if (discount.OldPrice != 0) { @discount.OldPrice.ToString()<small>.00</small>}
                                </del>
                            </div>
                        </div>
                        <div class="product-floating-btn">
                            <button class="btn js-put btn-primary btn-shadow btn-sm" id="@discount.Id" type="button" data-toggle="@discount.Name" data-target="#@discount.Name">+<i class="czi-cart font-size-base ml-1"></i></button>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</section>

<!-- Лидеры продаж -->

<section class="pt-5 pb-4">
    <!-- Заголовок-->
    <div class="d-flex flex-wrap justify-content-between align-items-center pt-1 border-bottom pb-4 mb-4">
        <h2 class="h3 mb-0 pt-3 mr-3">Лидеры продаж</h2>
        <div class="pt-3"><a class="btn btn-outline-accent btn-sm" href="/Home/Catalog?Filter=Bestsellers">Больше вариантов<i class="czi-arrow-right ml-1 mr-n1"></i></a></div>
    </div>
    <div class="cz-carousel cz-controls-static cz-controls-outside cz-dots-enabled pt-2">
        <div class="cz-carousel-inner" data-carousel-options="{&quot;items&quot;: 2, &quot;gutter&quot;: 16, &quot;controls&quot;: true, &quot;autoHeight&quot;: true, &quot;responsive&quot;: {&quot;0&quot;:{&quot;items&quot;:1}, &quot;480&quot;:{&quot;items&quot;:2}, &quot;720&quot;:{&quot;items&quot;:3}, &quot;991&quot;:{&quot;items&quot;:2}, &quot;1140&quot;:{&quot;items&quot;:3}, &quot;1300&quot;:{&quot;items&quot;:4}, &quot;1500&quot;:{&quot;items&quot;:5}}}">

            @foreach (var bestseller in Model.BestSellerList.ToList())
            {
                <div>
                    <div class="card product-card card-static pb-3">
                        @if (bestseller.DiscountProd == true)
                        {<span class="badge badge-danger badge-shadow">Sale</span>}
                        else if (bestseller.CrDate - DateTime.Now < new TimeSpan(50))
                        {<span class="badge badge-info badge-shadow">New</span>}
                        <button class="btn-wishlist btn-sm" type="button" id="@bestseller.Id" data-toggle="tooltip" data-placement="left" title="В избранное"><i class="czi-heart"></i></button>
                        <a class="card-img-top d-block overflow-hidden" href="/Home/Product/@bestseller.Id">
                            <img src="~/Images/Products/@bestseller.Photo.Split('#')[0]" alt="Product">
                        </a>
                        <div class="card-body py-2">
                            <a class="product-meta d-block font-size-xs" href="/Home/Catalog?Filter=Type&id=@bestseller.ProdTypeId.ToString()&sid=all&tid=all">@bestseller.ProdTypeName</a>
                            <h3 class="product-title font-size-base" style="margin-bottom:0.3rem"><a href="/Home/Product/@bestseller.Id">@bestseller.Name</a></h3>
                            <div class="product-price">
                                <span class="text-accent">₽ @bestseller.Price.ToString()<small>.00</small></span>
                                <span class="text-body">/ @bestseller.PriceFor</span>
                            </div>
                        </div>
                        <div class="product-floating-btn">
                            <button class="btn js-put btn-primary btn-shadow btn-sm" id="@bestseller.Id" type="button" data-toggle="@bestseller.Name" data-target="#@bestseller.Name">+<i class="czi-cart font-size-base ml-1"></i></button>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</section>

<!-- Отзывы -->

<section class="py-5 bg-light rounded-lg my-5 px-3 px-sm-4">
    <h2 class="h3 py-4 text-center">Отзывы клиентов</h2>
    <div class="cz-carousel mb-3">
        <div class="cz-carousel-inner" data-carousel-options="{&quot;items&quot;: 2, &quot;gutter&quot;: 20, &quot;controls&quot;: false, &quot;autoplay&quot;: true, &quot;autoplayTimeout&quot;: 5000, &quot;responsive&quot;: {&quot;0&quot;:{&quot;items&quot;:1}, &quot;576&quot;:{&quot;items&quot;:2},&quot;1200&quot;:{&quot;items&quot;:3},&quot;1560&quot;:{&quot;items&quot;:4}}}">

            @foreach (var review in Model.ReviewList.ToList())
            {
                <blockquote class="mb-2">
                    <div class="card border-0">
                        <span class="cz-testimonial-mark"></span>
                        <div class="card-body px-3 font-size-md text-muted">
                            <div class="mb-2">
                                <div class="star-rating">
                                    @for (var i = 0; i < review.Score; i++)
                                    {
                                        <i class="sr-star czi-star-filled active"></i>
                                    }
                                </div>
                            </div>@review.Body
                        </div>
                    </div>
                    <footer class="d-flex justify-content-center pt-4">
                        <div class="media align-items-center">
                            <img class="rounded-circle" width="50" src="~/Images/Customers/@review.CustomerPhoto" alt="@review.CustomerPhoto @review.CustomerSurName" />
                            <div class="media-body pl-3">
                                <h6 class="font-size-sm mb-n1">@review.CustomerName @review.CustomerSurName</h6><span class="font-size-ms text-muted opacity-75">@review.Date.ToString("D")</span>
                            </div>
                        </div>
                    </footer>
                </blockquote>
            }
        </div>
    </div>
</section>

<div class="pb-4"></div>

<!-- Добавлено в корзину -->

<div class="toast-container toast-bottom-center">
    <div class="toast ba-add mb-3" data-delay="2000" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header bg-success text-white">
            <i class="czi-check-circle mr-2"></i>
            <h6 class="font-size-sm text-white mb-0 mr-auto">Добавлено в Вашу корзину!</h6>
            <button class="close text-white ml-2 mb-1" type="button" data-dismiss="toast" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        </div>
        <div class="toast-body">Данный продукт был добавлен в Вашу корзину.</div>
    </div>
</div>

<!-- Добавлено в избранное -->

<div class="toast-container toast-bottom-center">
    <div class="toast wl-add mb-3" data-delay="2000" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header bg-info text-white">
            <i class="czi-bell mr-2"></i>
            <h6 class="font-size-sm text-white mb-0 mr-auto">Избранное</h6>
            <button class="close text-white ml-2 mb-1" type="button" data-dismiss="toast" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        </div>
        <div class="toast-body">Продукт добавлен в список избранного</div>
    </div>
</div>

<!-- Удалено из избранного -->

<div class="toast-container toast-bottom-center">
    <div class="toast wl-remowe mb-3" data-delay="2000" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header bg-dark text-white">
            <i class="czi-close-circle mr-2"></i>
            <h6 class="font-size-sm text-white mb-0 mr-auto">Избранное</h6>
            <button class="close text-white ml-2 mb-1" type="button" data-dismiss="toast" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        </div>
        <div class="toast-body">Продукт удален из списка избранного</div>
    </div>
</div>

<!-- Заказ успешно размещен -->

<div class="toast-container toast-bottom-center">
    <div class="toast order_succ mb-3" data-delay="2000" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header bg-success text-white">
            <i class="czi-check-circle mr-2"></i>
            <h6 class="font-size-sm text-white mb-0 mr-auto">Заказ!</h6>
            <button class="close text-white ml-2 mb-1" type="button" data-dismiss="toast" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        </div>
        <div class="toast-body">Ваш заказ успешно размещен, специалист свяжется в Вами в ближайшее время, спасибо.</div>
    </div>
</div>

<!-- Аккаунт удален -->

<div class="toast-container toast-bottom-center">
    <div class="toast del_succ mb-3" data-delay="2000" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header bg-success text-white">
            <i class="czi-check-circle mr-2"></i>
            <h6 class="font-size-sm text-white mb-0 mr-auto">Учетная запись!</h6>
            <button class="close text-white ml-2 mb-1" type="button" data-dismiss="toast" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        </div>
        <div class="toast-body">Ваша учетная запись успешно удалена.</div>
    </div>
</div>

@section scripts
    {
    <script>
        $(document).ready(function () {

            //Выделение избранного

            colorWishlist();

            //ИНФО

            let href = window.location.href;

            if (href.includes('order=True')) { $('.order_succ').toast('show'); sessionStorage.setItem('Basket', ''); }
            if (href.includes('delete=True')) { $('.del_succ').toast('show'); deleteCookie('wishlist');}
  
            //ПЕРЕХОД К КАТАЛОГУ

            $("ul li a.widget-list-link").click(function () {
                document.location.replace('/Home/Catalog?Filter=Type&id=' + $(this).attr("data-prodtype-id") + "&sid=" + $(this).attr("data-subtype-id") + "&tid=" + $(this).attr("data-thsubtype-id"));
            });

            $("#input_text").keydown(function (e) {
                if (e.keyCode === 13) {
                    document.location.replace('/Home/Catalog?Filter=Text&name=' + $("#input_text").val() + "&nid=" + $("select#input_type option:selected").attr("prodtype-id"));
                };
            });

            //РАБОТА С КОРЗИНОЙ

            //Инициализация корзины

            if (sessionStorage.getItem('Products') == null) getNewBasket();

            //Показ корзины

            updateBasket();
            updateHeader();

            //Добавление в корзину

            $(document).on('click', 'button.js-put', function () {
                $('.ba-add').toast('show');
                putIntoBasket($(this).attr("id"), 1);
                updateBasket();
                updateHeader();
            });

            //Удаление из корзины

            $(document).on('click', 'button.close', function () {
                deleteFromBasket($(this).attr('id'));
                updateHeader();
            });

            //Редактирование корзины

            $(document).on('click', 'button.js-minus', function () {
                editBasket($(this).attr('id'), "minus");
                updateHeader();
            });

            $(document).on('click', 'button.js-plus', function () {
                editBasket($(this).attr('id'), "plus");
                updateHeader();
            });

            //Заказ

            $(document).on('click', 'button.js-order', function () {
                getNewBasketOnServer();
            });


            //РАБОТА С ИЗБРАННЫМ

            $(document).on('click', 'button.btn-wishlist', function () {
                $('[data-toggle="tooltip"]').tooltip('dispose');
                editWishList($(this).attr('id'));
                colorWishlist();
                $('[data-toggle="tooltip"]').tooltip('enable');
            });

        });
    </script>
}
